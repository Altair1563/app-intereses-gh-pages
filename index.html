<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Intereses Escolares</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container">
        <header class="hero">
            <div class="hero__meta">
                <span class="chip chip--accent">Gesti√≥n administrativa</span>
                <span class="chip">Actualizado 2025</span>
            </div>
            <h1>üìö Calculadora de Intereses Escolares</h1>
            <p class="hero__description">Simul√° vencimientos, becas y montos finales con una interfaz moderna y f√°cil de usar.
            </p>
        </header>

        <!-- CONTENEDOR PRINCIPAL DE TABS -->
        <section class="tabs-container">
            <div class="panel">
                <div class="panel__head">
                    <h2 class="section-title">Acciones r√°pidas</h2>
                    <p class="section-subtitle">Eleg√≠ c√≥mo quer√©s trabajar con las cuotas y los intereses.</p>
                </div>
                <div class="tabs" id="tabsAcciones">
                    <button id="btnAplicarMensual" class="btn-aplicador verde">
                        üßÆ Aplicar intereses generales al sistema
                    </button>
                    <button id="btnAplicarPorCuota" class="btn-aplicador azul">
                        üè´ Ver cuotas por escuela
                    </button>
                </div>
            </div>

            <div class="panel panel--schools">
                <div class="panel__head">
                    <h2 class="section-title">Escuelas</h2>
                    <p class="section-subtitle">Seleccion√° una instituci√≥n para personalizar la simulaci√≥n.</p>
                </div>
                <div id="seccionEscuelas" class="tabs tabs--pills oculto">
                    <div class="tab active" data-escuela="Inicial">Inicial / Primaria</div>
                    <div class="tab" data-escuela="SecundariaMB">Secundaria MB</div>
                    <div class="tab" data-escuela="Tecnica">T√©cnica</div>
                    <div class="tab" data-escuela="Superior">Superior</div>
                </div>
            </div>
        </section>

        <main class="app-container">
            <!-- Formulario -->
            <section class="form-section card">
                <div class="section-heading">
                    <h2 id="tituloEscuela" class="section-title">Escuela: Inicial / Primaria</h2>
                    <p class="section-subtitle">Complet√° los datos para proyectar intereses y vencimientos.</p>
                </div>

                <form id="formCalculo" class="form">
                    <div class="field-group">
                        <label for="mesCuota">Mes de la cuota</label>
                        <select id="mesCuota" name="mesCuota" required>
                            <option value="">Seleccion√° el mes</option>
                            <option value="MARZO">Marzo</option>
                            <option value="ABRIL">Abril</option>
                            <option value="MAYO">Mayo</option>
                            <option value="JUNIO">Junio</option>
                            <option value="JULIO">Julio</option>
                            <option value="AGOSTO">Agosto</option>
                            <option value="SEPTIEMBRE">Septiembre</option>
                            <option value="OCTUBRE">Octubre</option>
                            <option value="NOVIEMBRE">Noviembre</option>
                        </select>
                    </div>

                    <!-- Valor Original (editable y oculto hasta seleccionar mes) -->
                    <div id="valorOriginalWrapper" class="field-group is-hidden">
                        <label for="valorOriginalInput">Valor original del mes seleccionado</label>
                        <input type="number" id="valorOriginalInput" step="0.01" placeholder="Ingres√° un valor manual">
                    </div>

                    <div class="field-group">
                        <label for="tipoBeca">Cuota / Beca</label>
                        <select id="tipoBeca" name="tipoBeca" required>
                            <option value="">Seleccion√° el tipo de beca</option>
                            <option value="COMPLETO">Cuota completa</option>
                            <option value="BECA 50%">Beca 50%</option>
                            <option value="BECA 25%">Beca 25%</option>
                            <option value="BECA 75%">Beca 75%</option>
                            <option value="BECA 100%">Beca 100%</option>
                        </select>
                    </div>

                    <div class="info-cards">
                        <div class="info-card">
                            <span class="info-card__label">Vencimiento original</span>
                            <input class="info-card__value info-field" type="text" id="fechaVencimiento" name="fechaVencimiento"
                                readonly placeholder="Seleccion√° un mes">
                        </div>
                        <div class="info-card">
                            <span class="info-card__label">Desde esta fecha lleva inter√©s</span>
                            <input class="info-card__value info-field" type="text" id="fechaInicioInteres"
                                name="fechaInicioInteres" readonly placeholder="Seleccion√° un mes">
                        </div>
                    </div>

                    <div class="field-group">
                        <label for="fechaPago">Fecha real de pago</label>
                        <input type="date" id="fechaPago" name="fechaPago" required>
                    </div>

                    <div class="form-footer">
                        <button type="submit" class="btn-calcular">Calcular inter√©s</button>
                    </div>
                </form>
            </section>

            <!-- Resultado -->
            <aside id="resultado" class="result-section card is-hidden"></aside>
        </main>

        <!-- Informaci√≥n de cuotas base -->
        <section class="info-section card">
            <div class="section-heading">
                <h3 class="section-title">Informaci√≥n de Cuotas Base (<span id="labelEscuelaTabla">Inicial / Primaria</span>)</h3>
                <p class="section-subtitle">Conoc√© los valores de referencia actualizados por instituci√≥n.</p>
            </div>
            <div id="tablaCuotas"></div>
        </section>
    </div>

    <script src="js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const btnAplicarMensual = document.getElementById('btnAplicarMensual');
            const btnAplicarPorCuota = document.getElementById('btnAplicarPorCuota');
            const seccionEscuelas = document.getElementById('seccionEscuelas');

            // Asegurarnos de que est√© oculto al inicio
            if (seccionEscuelas && !seccionEscuelas.classList.contains('oculto')) {
                seccionEscuelas.classList.add('oculto');
            }

            // Bot√≥n: abrir aplicador mensual (si quer√©s abrir otra p√°gina)
            if (btnAplicarMensual) {
                btnAplicarMensual.addEventListener('click', () => {
                    // si quer√©s abrir en la misma app cambialo por la funci√≥n correspondiente
                    window.location.href = 'aplicador_intereses.html';
                });
            }

            // Bot√≥n: mostrar/ocultar las tabs de escuelas
            if (btnAplicarPorCuota && seccionEscuelas) {
                btnAplicarPorCuota.addEventListener('click', () => {
                    seccionEscuelas.classList.toggle('oculto');

                    // Si se est√° mostrando, enfocamos la primer tab por accesibilidad
                    if (!seccionEscuelas.classList.contains('oculto')) {
                        const firstTab = seccionEscuelas.querySelector('.tab');
                        if (firstTab) firstTab.focus();
                    }
                });
            }

            // Manejar clics en las tabs de escuela
            const tabs = document.querySelectorAll('#seccionEscuelas .tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // quitar active a todas y poner en la seleccionada
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    const escuelaId = tab.dataset.escuela || tab.textContent.trim();
                    // Actualizar t√≠tulos/labels de la UI
                    const titulo = document.getElementById('tituloEscuela');
                    const labelTabla = document.getElementById('labelEscuelaTabla');
                    if (titulo) titulo.textContent = `Escuela: ${escuelaId}`;
                    if (labelTabla) labelTabla.textContent = escuelaId;

                    // Llamar a tu funci√≥n existente para cambiar escuela si est√° definida
                    if (typeof setEscuelaActiva === 'function') {
                        setEscuelaActiva(escuelaId);
                    } else if (typeof generarTablaCuotas === 'function') {
                        // fallback: regenerar tabla si no existe setEscuelaActiva
                        if (typeof window.escuelaActiva !== 'undefined') window.escuelaActiva = escuelaId;
                        generarTablaCuotas();
                    }
                });

                // Permitir selecci√≥n por teclado (Enter / Space)
                tab.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        tab.click();
                    }
                });

                // Hacer las tabs focusables
                tab.setAttribute('tabindex', '0');
            });
        });
    </script>
</body>

</html>