<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Calculadora de Intereses - Cuotas</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .contenedor {
            display: flex;
            flex-wrap: wrap;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            max-width: 900px;
            width: 100%;
        }

        .formulario {
            flex: 1;
            padding: 2rem;
            background: #f9fafc;
            min-width: 300px;
        }

        .resultado {
            flex: 1;
            background: #e9f7ef;
            padding: 2rem;
            display: none;
            animation: slideIn 0.6s ease;
            border-left: 3px solid #007bff;
        }

        h2 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: #333;
        }

        label {
            font-weight: 500;
            display: block;
            margin-top: 1rem;
        }

        select,
        button {
            width: 100%;
            padding: 0.6rem;
            margin-top: 0.5rem;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 1rem;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            margin-top: 1.5rem;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: #0056b3;
        }

        .info-section {
            background: #fff;
            padding: 1rem 2rem;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            width: 100%;
            margin-top: 2rem;
        }

        .tabla-cuotas {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tabla-cuotas th,
        .tabla-cuotas td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .tabla-cuotas th {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
        }

        .tabla-cuotas tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .tabla-cuotas tr:hover {
            background-color: #e9ecef;
        }

        .tabla-cuotas td {
            color: #495057;
            font-weight: 500;
        }

        .tabla-cuotas td:first-child {
            font-weight: 600;
            color: #2c3e50;
        }

        .linea {
            border-bottom: 1px dashed #999;
            margin: 12px 0;
        }

        .chequeo-table th,
        .chequeo-table td {
            text-align: center;
        }

        .nota {
            font-size: 0.9rem;
            color: #444;
            margin-top: 0.6rem;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>

<body>

    <div class="contenedor">
        <div class="formulario">
            <h2>üí∞ Calculadora de Intereses</h2>

            <label>Escuela:</label>
            <select id="escuela" onchange="mostrarTablaCuotas()">
                <option>INICIAL</option>
                <option>SECUNDARIAMB</option>
                <option>TECNICA</option>
                <option>SUPERIOR</option>
            </select>

            <label>Tipo de Beca:</label>
            <select id="beca">
                <option>COMPLETO</option>
                <option>BECA 75%</option>
                <option>BECA 50%</option>
                <option>BECA 25%</option>
                <option>BECA 100%</option>
            </select>

            <label>Mes actual (hasta d√≥nde chequear intereses):</label>
            <select id="mesActual"></select>

            <button onclick="calcularIntereses()">Calcular Intereses</button>
        </div>

        <div id="resultado" class="resultado"></div>
    </div>

    <div class="info-section">
        <h3>Informaci√≥n de Cuotas Base (<span id="labelEscuelaTabla">INICIAL</span>)</h3>
        <div id="tabla-cuotas"></div>


        <script>
            const ORDERED_MONTHS = ['MARZO', 'ABRIL', 'MAYO', 'JUNIO', 'JULIO', 'AGOSTO', 'SEPTIEMBRE', 'OCTUBRE', 'NOVIEMBRE', 'DICIEMBRE', 'ENERO', 'FEBRERO'];

            // Tasas mensuales (ejemplo): ajustar si necesit√°s otras tasas.
            const INTERESES_MAP = {
                'MAYO': 0.04,
                'JUNIO': 0.04,
                'JULIO': 0.0275,
                'AGOSTO': 0.0275,
                'SEPTIEMBRE': 0.0275,
                'OCTUBRE': 0.0275,
                'NOVIEMBRE': 0.0275,
                'DICIEMBRE': 0.0275,
                'ENERO': 0.0275,
                'FEBRERO': 0.0275
            };

            // CUOTAS por escuela y por mes (MARZO..NOVIEMBRE). Valores provistos por vos.
            const CUOTAS_POR_ESCUELA = {
                'INICIAL': {
                    'MARZO': { 'COMPLETO': 69030, 'BECA 75%': 27563.32, 'BECA 50%': 41385.55, 'BECA 25%': 55207.79, 'BECA 100%': 13741.11 },
                    'ABRIL': { 'COMPLETO': 70940, 'BECA 75%': 28290, 'BECA 50%': 42506.66, 'BECA 25%': 56723.34, 'BECA 100%': 14073.34 },
                    'MAYO': { 'COMPLETO': 70940, 'BECA 75%': 28290, 'BECA 50%': 42506.66, 'BECA 25%': 56723.34, 'BECA 100%': 14073.34 },
                    'JUNIO': { 'COMPLETO': 75410, 'BECA 75%': 29993.35, 'BECA 50%': 45132.24, 'BECA 25%': 60271.11, 'BECA 100%': 14854.46 },
                    'JULIO': { 'COMPLETO': 78580, 'BECA 75%': 31263.33, 'BECA 50%': 47035.56, 'BECA 25%': 62807.79, 'BECA 100%': 15491.12 },
                    'AGOSTO': { 'COMPLETO': 78580, 'BECA 75%': 31263.33, 'BECA 50%': 47035.56, 'BECA 25%': 62807.79, 'BECA 100%': 15491.12 },
                    'SEPTIEMBRE': { 'COMPLETO': 80710, 'BECA 75%': 32076.67, 'BECA 50%': 48287.78, 'BECA 25%': 64498.89, 'BECA 100%': 15865.56 },
                    'OCTUBRE': { 'COMPLETO': 82890, 'BECA 75%': 32906.67, 'BECA 50%': 49567.77, 'BECA 25%': 66228.89, 'BECA 100%': 16245.56 },
                    'NOVIEMBRE': { 'COMPLETO': 82890, 'BECA 75%': 32906.67, 'BECA 50%': 49567.77, 'BECA 25%': 66228.89, 'BECA 100%': 16245.56 }
                },
                'SECUNDARIAMB': {
                    'MARZO': { 'COMPLETO': 75890, 'BECA 75%': 30173.34, 'BECA 50%': 45412.23, 'BECA 25%': 60651.12, 'BECA 100%': 14934.46 },
                    'ABRIL': { 'COMPLETO': 77970, 'BECA 75%': 30970, 'BECA 50%': 46636.66, 'BECA 25%': 62303.34, 'BECA 100%': 15303.34 },
                    'MAYO': { 'COMPLETO': 77970, 'BECA 75%': 30970, 'BECA 50%': 46636.66, 'BECA 25%': 62303.34, 'BECA 100%': 15303.34 },
                    'JUNIO': { 'COMPLETO': 82900, 'BECA 75%': 32850.01, 'BECA 50%': 49533.34, 'BECA 25%': 66216.67, 'BECA 100%': 16166.68 },
                    'JULIO': { 'COMPLETO': 86390, 'BECA 75%': 34240.01, 'BECA 50%': 51623.34, 'BECA 25%': 69006.67, 'BECA 100%': 16856.68 },
                    'AGOSTO': { 'COMPLETO': 86390, 'BECA 75%': 34240.01, 'BECA 50%': 51623.34, 'BECA 25%': 69006.67, 'BECA 100%': 16856.68 },
                    'SEPTIEMBRE': { 'COMPLETO': 88730, 'BECA 75%': 35130, 'BECA 50%': 52996.66, 'BECA 25%': 70863.34, 'BECA 100%': 17263.34 },
                    'OCTUBRE': { 'COMPLETO': 91160, 'BECA 75%': 36060, 'BECA 50%': 54426.66, 'BECA 25%': 72793.34, 'BECA 100%': 17693.34 },
                    'NOVIEMBRE': { 'COMPLETO': 91160, 'BECA 75%': 36060, 'BECA 50%': 54426.66, 'BECA 25%': 72793.34, 'BECA 100%': 17693.34 }
                },
                'TECNICA': {
                    'MARZO': { 'COMPLETO': 78610, 'BECA 75%': 31210.01, 'BECA 50%': 47010.01, 'BECA 25%': 62810, 'BECA 100%': 15410.01 },
                    'ABRIL': { 'COMPLETO': 80820, 'BECA 75%': 32055, 'BECA 50%': 48309.99, 'BECA 25%': 64565, 'BECA 100%': 15800 },
                    'MAYO': { 'COMPLETO': 80820, 'BECA 75%': 32055, 'BECA 50%': 48309.99, 'BECA 25%': 64565, 'BECA 100%': 15800 },
                    'JUNIO': { 'COMPLETO': 85930, 'BECA 75%': 34000.01, 'BECA 50%': 51310.01, 'BECA 25%': 68620.02, 'BECA 100%': 16690.02 },
                    'JULIO': { 'COMPLETO': 89550, 'BECA 75%': 35445.01, 'BECA 50%': 53480.01, 'BECA 25%': 71515, 'BECA 100%': 17410.01 },
                    'AGOSTO': { 'COMPLETO': 89550, 'BECA 75%': 35445.01, 'BECA 50%': 53480.01, 'BECA 25%': 71515, 'BECA 100%': 17410.01 },
                    'SEPTIEMBRE': { 'COMPLETO': 91970, 'BECA 75%': 36365.02, 'BECA 50%': 54900.02, 'BECA 25%': 73435, 'BECA 100%': 17830.02 },
                    'OCTUBRE': { 'COMPLETO': 94470, 'BECA 75%': 37320.01, 'BECA 50%': 56370.01, 'BECA 25%': 75420.01, 'BECA 100%': 18270.01 },
                    'NOVIEMBRE': { 'COMPLETO': 94470, 'BECA 75%': 37320.01, 'BECA 50%': 56370.01, 'BECA 25%': 75420.01, 'BECA 100%': 18270.01 }
                },
                'SUPERIOR': {
                    'MARZO': { 'COMPLETO': 69570, 'BECA 75%': 27768.34, 'BECA 50%': 41702.23, 'BECA 25%': 55636.11, 'BECA 100%': 13834.45 },
                    'ABRIL': { 'COMPLETO': 71490, 'BECA 75%': 28498.33, 'BECA 50%': 42828.89, 'BECA 25%': 57159.45, 'BECA 100%': 14167.78 },
                    'MAYO': { 'COMPLETO': 71490, 'BECA 75%': 28498.33, 'BECA 50%': 42828.89, 'BECA 25%': 57159.45, 'BECA 100%': 14167.78 },
                    'JUNIO': { 'COMPLETO': 76000, 'BECA 75%': 30220, 'BECA 50%': 45480, 'BECA 25%': 60740, 'BECA 100%': 14960 },
                    'JULIO': { 'COMPLETO': 79190, 'BECA 75%': 31496.67, 'BECA 50%': 47394.44, 'BECA 25%': 63292.22, 'BECA 100%': 15598.89 },
                    'AGOSTO': { 'COMPLETO': 79190, 'BECA 75%': 31496.67, 'BECA 50%': 47394.44, 'BECA 25%': 63292.22, 'BECA 100%': 15598.89 },
                    'SEPTIEMBRE': { 'COMPLETO': 81340, 'BECA 75%': 32316.68, 'BECA 50%': 48657.79, 'BECA 25%': 64998.89, 'BECA 100%': 15975.57 },
                    'OCTUBRE': { 'COMPLETO': 83560, 'BECA 75%': 33161.18, 'BECA 50%': 49960.78, 'BECA 25%': 66760.39, 'BECA 100%': 16361.57 },
                    'NOVIEMBRE': { 'COMPLETO': 83560, 'BECA 75%': 33161.18, 'BECA 50%': 49960.78, 'BECA 25%': 66760.39, 'BECA 100%': 16361.57 }
                }
            };

            // REGLA_INTERESES original (la mantenemos por compatibilidad, pero el chequeo nuevo
            // usa INTERESES_MAP + orden para decidir qu√© meses aportaron intereses).
            const REGLA_INTERESES = {
                'MAYO': 'MARZO',
                'JUNIO': 'ABRIL',
                'JULIO': 'MAYO',
                'AGOSTO': 'JUNIO',
                'SEPTIEMBRE': 'JULIO',
                'OCTUBRE': 'AGOSTO',
                'NOVIEMBRE': 'SEPTIEMBRE',
                'DICIEMBRE': 'OCTUBRE',
                'ENERO': 'NOVIEMBRE',
                'FEBRERO': 'NOVIEMBRE'
            };

            // Poblamos select de meses (mostramos MARZO..FEBRERO)
            window.onload = () => {
                const selMes = document.getElementById('mesActual');
                ORDERED_MONTHS.forEach(m => {
                    const opt = document.createElement('option');
                    opt.text = m;
                    opt.value = m;
                    selMes.appendChild(opt);
                });
                mostrarTablaCuotas();
            };

            function mostrarTablaCuotas() {
                const escuela = document.getElementById('escuela').value;
                const label = document.getElementById('labelEscuelaTabla');
                const tablaDiv = document.getElementById('tabla-cuotas');
                const datos = CUOTAS_POR_ESCUELA[escuela];

                label.textContent = escuela;

                if (!datos) {
                    tablaDiv.innerHTML = "<p>No hay datos de cuotas para esta escuela.</p>";
                    return;
                }

                let tabla = `<table class="tabla-cuotas">
                <thead>
                    <tr>
                        <th>Mes</th>
                        <th>COMPLETO</th>
                        <th>75%</th>
                        <th>50%</th>
                        <th>25%</th>
                        <th>100%</th>
                    </tr>
                </thead>
                <tbody>`;

                for (const mes of ORDERED_MONTHS) {
                    // Solo mostramos MARZO..NOVIEMBRE en la tabla de cuotas base (si existen).
                    if (!datos[mes]) continue;

                    const c = datos[mes];
                    tabla += `
                    <tr>
                        <td>${mes}</td>
                        <td>$${formatNumber(c["COMPLETO"])}</td>
                        <td>$${formatNumber(c["BECA 75%"])}</td>
                        <td>$${formatNumber(c["BECA 50%"])}</td>
                        <td>$${formatNumber(c["BECA 25%"])}</td>
                        <td>$${formatNumber(c["BECA 100%"])}</td>
                    </tr>`;
                }

                tabla += "</tbody></table>";
                tablaDiv.innerHTML = tabla;
            }

            // Funci√≥n principal: calcula intereses como ven√≠as haciendo + chequeo por mes base (MARZO..NOVIEMBRE)
            function calcularIntereses() {
                const escuela = document.getElementById('escuela').value;
                const beca = document.getElementById('beca').value;
                const mesActual = document.getElementById('mesActual').value;
                const resultado = document.getElementById('resultado');

                // Validaci√≥n b√°sica
                if (!ORDERED_MONTHS.includes(mesActual)) {
                    resultado.innerHTML = '<p>Seleccion√° un mes v√°lido.</p>';
                    resultado.style.display = 'block';
                    return;
                }

                // --- Parte 1: (tu listado de intereses por regla original) ---
                // En tu c√≥digo original estabas usando REGLA_INTERESES para determinar hasta qu√© mes
                // sumar (idxLimite). Lo mantenemos pero lo mostramos como detalle.
                const mesLimite = REGLA_INTERESES[mesActual];
                let detalleAnterior = '';
                if (mesLimite) {
                    const idxLimite = ORDERED_MONTHS.indexOf(mesLimite);
                    const idxActual = ORDERED_MONTHS.indexOf(mesActual);
                    // para mantener compatibilidad con la l√≥gica previa:
                    const interesActual = (INTERESES_MAP[mesActual] !== undefined) ? INTERESES_MAP[mesActual] : 0;

                    let salida = `<h3>üí° Resultados de Intereses (vista r√°pida - regla existente) ‚Äî ${mesActual}</h3><hr>`;
                    let totalInteres = 0;

                    for (let i = 0; i <= idxLimite; i++) {
                        const mes = ORDERED_MONTHS[i];
                        const cuota = CUOTAS_POR_ESCUELA[escuela]?.[mes]?.[beca];
                        if (!cuota) continue;

                        const montoInteres = cuota * interesActual;
                        totalInteres += montoInteres;

                        salida += `
                        <div><b>${mes}:</b> Inter√©s ${(interesActual * 100).toFixed(2)}% ‚Üí $${formatNumber(montoInteres)}</div>
                        <div class="linea"></div>
                    `;
                    }

                    salida += `<h4>Total intereses aplicados (regla existente): $${formatNumber(totalInteres)}</h4>`;
                    detalleAnterior = salida;
                } else {
                    detalleAnterior = `<p>La regla de intereses no define un mes base para ${mesActual} (no hay c√°lculo de 'regla existente').</p>`;
                }

                // --- Parte 2: Chequeo solicitado por vos ‚Äî calculo acumulado por cuota base (MARZO..NOVIEMBRE) ---
                // Regla para chequeo: para cada mes base (MARZO..NOVIEMBRE) sumar, hasta mesActual,
                // todos los intereses mensuales cuya fecha sea posterior al mes base.
                // Usamos INTERESES_MAP para las tasas; la suma es simple (no compuesta).
                const chequearHastaIdx = ORDERED_MONTHS.indexOf(mesActual);
                const baseMonths = ORDERED_MONTHS.slice(0, ORDERED_MONTHS.indexOf('NOVIEMBRE') + 1); // MARZO..NOVIEMBRE

                let tablaChequeo = `
                <h3>üîé Chequeo acumulado por cuota base (inter√©s simple hasta ${mesActual})</h3>
                <table class="tabla-cuotas chequeo-table">
                    <thead>
                        <tr>
                            <th>Mes Base</th>
                            <th>Cuota base (${beca})</th>
                            <th>Total intereses aplicados</th>
                            <th>Valor final (base + intereses)</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

                let anyRow = false;
                for (const baseMes of baseMonths) {
                    const cuota = CUOTAS_POR_ESCUELA[escuela]?.[baseMes]?.[beca];
                    if (!cuota) continue;

                    // sumar intereses mensuales m tales que:
                    // index(m) > index(baseMes) && index(m) <= chequearHastaIdx && m pertenece a INTERESES_MAP
                    let totalInteresAplicado = 0;
                    for (const m of Object.keys(INTERESES_MAP)) {
                        const idxM = ORDERED_MONTHS.indexOf(m);
                        if (idxM === -1) continue;
                        const idxBase = ORDERED_MONTHS.indexOf(baseMes);
                        if (idxM > idxBase && idxM <= chequearHastaIdx) {
                            const tasa = INTERESES_MAP[m];
                            totalInteresAplicado += cuota * tasa;
                        }
                    }

                    const valorFinal = cuota + totalInteresAplicado;
                    tablaChequeo += `
                    <tr>
                        <td>${baseMes}</td>
                        <td>$${formatNumber(cuota)}</td>
                        <td>$${formatNumber(totalInteresAplicado)}</td>
                        <td>$${formatNumber(valorFinal)}</td>
                    </tr>
                `;
                    anyRow = true;
                }

                if (!anyRow) {
                    tablaChequeo += `<tr><td colspan="4">No hay cuotas base (MARZO..NOVIEMBRE) para la escuela/beca seleccionada.</td></tr>`;
                }

                tablaChequeo += `</tbody></table>`;

                // --- Renderizamos ambas partes ---
                resultado.innerHTML = detalleAnterior + '<div style="margin-top:18px;"></div>' + tablaChequeo;
                resultado.style.display = 'block';

                // Tambi√©n colocamos la tabla de chequeo en la secci√≥n inferior (tabla-chequeo) para visibilidad.
                document.getElementById('tabla-chequeo').innerHTML = tablaChequeo;
            }

            // util: formatear n√∫meros con coma decimal y separador de miles
            function formatNumber(n) {
                return Number(n).toLocaleString('es-AR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            }
        </script>
</body>

</html>